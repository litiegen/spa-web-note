var menu={fontHandler:function(t){menu.fontFamily=t.family,menu.fontStype=t.style,menu.fontSize=t.size,$editor.setFont(t)}};$(function(){$editor.show(),$editor.setFont({family:"Arial",style:"常规",size:"16"}),$menubar.show(menu.json),$("body").click(function(){$menubar.hideMenu()})}),menu.json=[{title:"文件(F)",menuItems:[{title:"新建(N)",txt:"Ctrl+N",handler:function(){console.log("文件(F) check")}},{title:"退出(X)",handler:function(){console.log("退出(X) check")}}],width:"200px",left:"0px"},{title:"编辑(E)",menuItems:[{title:"撤销(U)",txt:"Ctrl+Z",handler:function(){console.log("撤销(U) check")}},{title:"剪切(T)",txt:"Ctrl+X",handler:function(){console.log("剪切(T) check")}}],width:"200px",left:"54px"},{title:"格式(O)",menuItems:[{title:"字体(F)...",handler:function(){$Font.show({family:menu.fontFamily,style:menu.fontStyle,size:menu.fontSize,okHandler:menu.fontHandler})}}],width:"120px",left:"108px"},{title:"查看(V)",menuItems:[{title:"状态栏",handler:function(){console.log("状态栏 check")}}],width:"120px",left:"162px"},{title:"帮助(H)",menuItems:[{title:"关于记事本",handler:function(){console.log("关于记事本 check")}}],width:"140px",left:"216px"}];var $menubar=function(){var s,o=$('<div class="notepad-menubar"></div>'),a=[],c=-1;return{show:function(t){s=t,function(){for(var t=$('<ul class="menu-title"></ul>'),e=0;e<s.length;e++){var n=$('<li class="title"></li>');n.attr("data-id",e),n.html(s[e].title),t.append(n),n.click(function(t){var e=Number(this.dataset.id);c=-1===c?(a[e].css({display:"inline-block"}),e):c!==e?(a[c].css({display:"none"}),a[e].css({display:"inline-block"}),e):(a[c].css({display:"none"}),-1),t.stopPropagation()})}o.append(t)}(),function(){for(var t=0;t<s.length;t++){for(var e=$('<ul class="menus"></ul>'),n=s[t].menuItems,l=0;l<n.length;l++){var i=$('<li class="menu-item"></li>');i.html(n[l].title),i.attr("data-x",t),i.attr("data-y",l),""!==n[l].txt&&i.append($('<span class="txt"></span>').html(n[l].txt)),e.append(i),i.click(function(){a[this.dataset.x].css({display:"none"}),c=-1,s[this.dataset.x].menuItems[this.dataset.y].handler()})}e.css({width:s[t].width,left:s[t].left,display:"none"}),o.append(e),a.push(e)}}(),$("body").append(o)},hideMenu:function(){-1!==c&&(a[c].css({display:"none"}),c=-1)}}}(),$editor=function(){var t=$('<div class="notepad-editor"><textarea spellcheck="false" auto-size="none"></textarea></div>'),e=t.find("textarea");return{show:function(){$("body").append(t)},setFont:function(t){return e.css({"font-family":t.family,"font-size":t.size+"pt"}),"斜体"===t.style?void e.css({"font-style":"italic","font-weight":""}):"粗体"===t.style?void e.css({"font-style":"","font-weight":"bold"}):"粗偏斜体"===t.style?void e.css({"font-style":"italic","font-weight":"bold"}):void e.css({"font-style":"","font-weight":""})}}}();function List(){var n,t=$('<div class="notepad-com-list"><input class="editor" type="text"><br><ul class="list"></ul></div>'),e=t.find(".editor"),l=t.find(".list"),i={};function s(){0!==$(i.container).find(".notepad-com-list").length&&$(i.container).find(".notepad-com-list").remove(),$(i.container).append(t),t.css({width:i.width}),function(){var t,e=0;if(console.log(i),i.isFont)for(e=0;e<i.list.length;e++)(t=$('<li class="item"></li>')).css({"font-family":i.list[e]}),l.append(t.html(i.list[e]));else if(i.isFontStyle)for(e=0;e<i.list.length;e++)t=$('<li class="item"></li>'),l.append(t.html(i.list[e]));else for(e=0;e<i.list.length;e++)t=$('<li class="item"></li>'),l.append(t.html(i.list[e]));n=l.find(".item")}(),$(n[i.select]).addClass("selected"),e.val(i.list[i.select]),e.select()}this.show=function(t){$.extend(i,t),s(),l.click(function(t){$(n[i.select]).removeClass("selected"),i.select=i.list.indexOf($(t.target).html()),$(n[i.select]).addClass("selected"),e.val(i.list[i.select]),e.select(),i.selectHandler(i.select)})}}var $Font=function(){var e=$('<div class="notepad-dlg-mask notepad-dlg-font"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">字体</p><span class="close-btn" title="关闭">✖</span></div><div class="main notepad-dlg-main"><div class="font-family"><p>字体(F):</p></div><div class="font-style"><p>字形(Y):</p></div><div class="font-size"><p>大小(S):</p></div><fieldset class="sample"><legend>示例</legend><p class="sample-txt">AaBbYyZz</p></fieldset><div class="script"><label>脚本(R):<br><select><option value="西欧语言">西欧语言</option><option value="中文 GB2312">中文 GB2312</option></select></label></div><input class="btn-ok btn" type="button" value="确定"><input class="btn-cancel btn" type="button" value="取消"></div></div></div>'),n=e.find(".btn-ok"),l=e.find(".close-btn"),i=e.find(".btn-cancel"),t=e.find(".sample-txt"),s=["Agency FB","Algerian","Arial","Arial Rounded MT","Axure Handwriting","Bahnschrift","Baskerville Old Face","Bauhaus 93","Bell MT","Berlin Sans FB","Bernard MT","BlackAdder ITC"],o=["常规","斜体","粗体","粗偏斜体"],a=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"],c={family:"Arial",style:"常规",size:"16"};function d(){return t.css({"font-family":c.family,"font-size":c.size+"pt"}),"斜体"===c.style?void t.css({"font-weight":"","font-style":"italic"}):"粗体"===c.style?void t.css({"font-weight":"bold","font-style":""}):"粗偏斜体"===c.style?void t.css({"font-weight":"bold","font-style":"italic"}):void t.css({"font-weight":"","font-style":""})}function f(){e.remove()}return{show:function(t){$.extend(c,t),$("body").append(e),(new List).show({container:".notepad-dlg-font .font-family",width:"170px",list:s,select:s.indexOf(c.family),isFont:!0,selectHandler:function(t){c.family=s[t],d()}}),(new List).show({container:".notepad-dlg-font .font-style",width:"120px",list:o,select:o.indexOf(c.style),isFontStyle:!0,selectHandler:function(t){c.style=o[t],d()}}),(new List).show({container:".notepad-dlg-font .font-size",width:"60px",list:a,select:a.indexOf(c.size),selectHandler:function(t){c.size=a[t],d()}}),d(),l.click(f),i.click(f),n.click(function(){c.okHandler({family:c.family,style:c.style,size:c.size}),f()}),e.click(function(t){t.stopPropagation()})}}}();